{
  "pack_id": "ch3",
  "version": "1.0.0",
  "modules": [
    {
      "id": "ch3-mod1",
      "title": "Malware basics: how Security+ wants you to classify it",
      "tag_ids": [
        "malware.basics",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod1-p1",
          "title": "Classify by goal, spread, and indicators",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Malware is software intentionally built to harm systems, steal information, or enable unauthorized access. On Security+, you identify malware families by PRIMARY intent (money, access, spying, sabotage), how it spreads (user-run vs self-spread), and what it hides or changes (persistence, stealth)."
            },
            {
              "type": "diagram",
              "text": "Fast malware ID:\n1) Goal: money? access? spying? sabotage?\n2) Spread: user-run? self-spread? embedded in legit app?\n3) Stealth: rootkit/fileless behaviors?\n4) IoCs: C2 traffic, encryption, new services, strange processes"
            },
            {
              "type": "example",
              "text": "A fake update that needs a user click is likely a Trojan. A fast-spreading outbreak without user action points to a worm. A sudden ransom note after file encryption points to ransomware."
            },
            {
              "type": "trap",
              "text": "Exam trap: confusing the DELIVERY vector (phishing, USB, drive-by) with the malware FAMILY. The vector is how it got in; the family is what it does."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Which factor MOST helps classify malware families on Security+?",
              "options": [
                "The file extension used during delivery",
                "The primary intent and behavior of the malware",
                "The brand of antivirus that detected it",
                "The operating system version"
              ],
              "correct_index": 1,
              "explanation": "Classification focuses on intent and behavior (goal + propagation + stealth), not the delivery method or OS details.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which are common indicators of compromise (IoCs)? (Select all that apply.)",
              "options": [
                "Beaconing to an unknown C2 domain",
                "Known malicious file hash",
                "New suspicious scheduled task",
                "User security training policy"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "IoCs are artifacts of compromise such as C2 traffic, hashes, and persistence changes. Policies are not IoCs.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod2",
      "title": "Ransomware: crypto-malware and extortion playbooks",
      "tag_ids": [
        "malware.ransomware",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod2-p1",
          "title": "Identify and respond to ransomware",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Ransomware encrypts or locks data and demands payment. Modern variants often use double extortion: steal data first, then threaten exposure. The safest recovery path is isolation + evidence capture + restore from known-good backups."
            },
            {
              "type": "diagram",
              "text": "Common clues:\n- Rapid file encryption + new extensions\n- Ransom note\n- Unusual CPU/disk spikes\nBest response:\n1) Isolate host\n2) Preserve evidence (hashes, notes, IoCs)\n3) Restore/rebuild from known-good sources"
            },
            {
              "type": "trap",
              "text": "Exam trap: paying the ransom is not a reliable fix. The correct answer usually favors isolation, backups, and rebuilds."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "A workstation shows a ransom note and encrypted files. What is the BEST immediate action?",
              "options": [
                "Leave it online to monitor the attacker",
                "Isolate the host from the network to stop spread",
                "Disable logging to reduce noise",
                "Pay the ransom immediately"
              ],
              "correct_index": 1,
              "explanation": "Isolating the host limits lateral spread and buys time to investigate safely.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "cloze",
              "prompt": "Ransomware commonly uses ____ to lock files and demands ____ for recovery.",
              "answers": [
                "encryption",
                "payment"
              ],
              "explanation": "Crypto-malware encrypts files and demands payment for decryption.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod3",
      "title": "Trojans and RATs: disguised access",
      "tag_ids": [
        "malware.trojan",
        "malware.rat",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod3-p1",
          "title": "Trojan vs RAT patterns",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Trojans masquerade as legitimate software and require user execution. A Remote Access Trojan (RAT) is a trojan that grants the attacker remote control and persistence."
            },
            {
              "type": "diagram",
              "text": "Trojan: user runs it -> installs payload\nRAT: trojan + command channel + remote control\nTypical delivery: phishing, fake updates, cracked software"
            },
            {
              "type": "trap",
              "text": "Exam trap: trojans do NOT self-spread. If it spreads automatically, that is a worm."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Which statement BEST differentiates a Trojan from a worm?",
              "options": [
                "Trojans are always ransomware",
                "Trojans require user execution; worms self-spread",
                "Trojans only target mobile devices",
                "Worms are always fileless"
              ],
              "correct_index": 1,
              "explanation": "Trojans rely on user execution while worms spread automatically.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which indicators are common for a RAT? (Select all that apply.)",
              "options": [
                "Regular outbound beacons to a C2 host",
                "New persistence service or startup entry",
                "Remote control tools running unexpectedly",
                "A ransom note"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "RATs often beacon, persist, and provide remote control. Ransom notes are ransomware.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod4",
      "title": "Bots, botnets, and C2 traffic",
      "tag_ids": [
        "malware.botnet",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod4-p1",
          "title": "Botnet behavior and detection",
          "content_blocks": [
            {
              "type": "explain",
              "text": "A botnet is a group of compromised hosts (bots) controlled by command-and-control (C2). Botnets drive DDoS, spam, credential stuffing, and crypto mining."
            },
            {
              "type": "diagram",
              "text": "Botnet flow:\nInfection -> beacon to C2 -> receive commands -> execute (DDoS/spam/exfil)"
            },
            {
              "type": "trap",
              "text": "Exam trap: C2 traffic can blend into normal HTTP/HTTPS. Baselines and anomaly detection matter."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "A botnet is best described as:",
              "options": [
                "A worm that only spreads via email",
                "A set of compromised hosts under centralized command",
                "A backup system for malware",
                "A type of antivirus signature"
              ],
              "correct_index": 1,
              "explanation": "Botnets are collections of compromised hosts controlled via C2.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "cloze",
              "prompt": "C2 stands for ____ and ____.",
              "answers": [
                "command",
                "control"
              ],
              "explanation": "C2 is the command-and-control channel used by attackers.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod5",
      "title": "Worms: self-spreading outbreaks",
      "tag_ids": [
        "malware.worm",
        "malware.basics",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod5-p1",
          "title": "Worm propagation and containment",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Worms self-spread without user interaction, often exploiting vulnerabilities or open services. They can move fast across networks."
            },
            {
              "type": "example",
              "text": "Example: A worm uses an SMB vulnerability to jump between hosts and causes a rapid internal outbreak."
            },
            {
              "type": "trap",
              "text": "Exam trap: if user interaction is required, it is not a worm."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "A malware outbreak spreads rapidly with no user clicks. Most likely?",
              "options": [
                "Trojan",
                "Worm",
                "Spyware",
                "Logic bomb"
              ],
              "correct_index": 1,
              "explanation": "Self-spread without user action strongly indicates a worm.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which controls help limit worm spread? (Select all that apply.)",
              "options": [
                "Timely patching",
                "Network segmentation",
                "Disabling unnecessary services",
                "Only user security training"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "Patching, segmentation, and reducing exposed services limit worm propagation.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod6",
      "title": "Spyware: information theft by intent",
      "tag_ids": [
        "malware.spyware",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod6-p1",
          "title": "Spyware intent and indicators",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Spyware is defined by intent: it gathers information about the user or system. It may arrive via trojan or bundling, but its primary goal is data collection."
            },
            {
              "type": "example",
              "text": "Browser add-ons that track credentials or browsing history are classic spyware behaviors."
            },
            {
              "type": "trap",
              "text": "Exam trap: do not confuse spyware with delivery methods. The differentiator is the data-gathering intent."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Spyware is best defined by its:",
              "options": [
                "Ability to self-spread",
                "Primary intent to gather information",
                "Use of encryption",
                "Targeting only mobile devices"
              ],
              "correct_index": 1,
              "explanation": "Spyware is classified by its intent to collect information.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "cloze",
              "prompt": "Spyware often targets ____ and ____.",
              "answers": [
                "information",
                "credentials"
              ],
              "explanation": "Spyware is about information gathering, often focusing on credentials.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod7",
      "title": "Bloatware/PUPs: unwanted software risk",
      "tag_ids": [
        "malware.bloatware",
        "malware.basics",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod7-p1",
          "title": "Why bloatware still matters",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Bloatware (often called PUPs) is unwanted preinstalled software. It is not always malicious, but it adds attack surface, can be vulnerable, and may call home."
            },
            {
              "type": "example",
              "text": "OEM utilities running as services can expose unpatched interfaces or outdated libraries."
            },
            {
              "type": "trap",
              "text": "Exam trap: bloatware is usually not malware, but the security risk comes from unnecessary exposure and vulnerabilities."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Which action BEST reduces bloatware risk on managed endpoints?",
              "options": [
                "Install more toolbars",
                "Use a clean base image and remove unnecessary software",
                "Disable backups",
                "Allow unsigned drivers"
              ],
              "correct_index": 1,
              "explanation": "A clean image and removal of unnecessary software reduces attack surface.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Why can bloatware be a security risk? (Select all that apply.)",
              "options": [
                "Unnecessary services increase attack surface",
                "Vulnerable components may be unpatched",
                "It can generate unexpected outbound traffic",
                "It always encrypts files"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "Bloatware increases exposure and can be vulnerable or chatty. It does not inherently encrypt files.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod8",
      "title": "Viruses and fileless malware",
      "tag_ids": [
        "malware.virus",
        "malware.fileless",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod8-p1",
          "title": "Triggers, payloads, and memory-only attacks",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Viruses typically attach to files and execute when triggered, delivering a payload. Fileless malware runs primarily in memory and can persist via registry or scheduled tasks without storing a main executable on disk."
            },
            {
              "type": "diagram",
              "text": "Virus = trigger + payload\nFileless = memory-resident + persistence (registry/tasks) + minimal disk artifacts"
            },
            {
              "type": "trap",
              "text": "Exam trap: fileless does not mean artifact-free. Logs, registry keys, and network behavior still leave evidence."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "The payload of a virus is best described as:",
              "options": [
                "The condition that causes execution",
                "The action the virus performs when it runs",
                "The vulnerability it exploits to spread",
                "The file extension it hides under"
              ],
              "correct_index": 1,
              "explanation": "Payload is what the virus does when it executes.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which clues suggest fileless malware? (Select all that apply.)",
              "options": [
                "Registry persistence without a new executable",
                "PowerShell or script activity spikes",
                "In-memory injection behavior",
                "A boot sector modification only"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "Fileless attacks often rely on memory and scripting with registry-based persistence.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod9",
      "title": "Keyloggers: credential theft",
      "tag_ids": [
        "malware.keylogger",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod9-p1",
          "title": "Detect and reduce keylogger impact",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Keyloggers capture keystrokes and often steal credentials. They may be software-based or hardware-based. The best mitigation for stolen passwords is MFA."
            },
            {
              "type": "example",
              "text": "If a password is captured, MFA still blocks access without the second factor."
            },
            {
              "type": "trap",
              "text": "Exam trap: strong passwords alone do not stop keyloggers. MFA is the key compensating control."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Which control MOST reduces the impact of credential theft from a keylogger?",
              "options": [
                "Disable screen locking",
                "Enable multifactor authentication (MFA)",
                "Turn off antivirus",
                "Allow unsigned macros"
              ],
              "correct_index": 1,
              "explanation": "MFA reduces the impact of stolen passwords.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which are common IoCs for keyloggers? (Select all that apply.)",
              "options": [
                "Unknown process names",
                "Outbound exfiltration to C2",
                "Known malicious hashes",
                "A ransomware note"
              ],
              "correct_indices": [
                0,
                1,
                2
              ],
              "explanation": "Keyloggers show process artifacts, hashes, and exfiltration.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod10",
      "title": "Logic bombs: condition-triggered sabotage",
      "tag_ids": [
        "malware.logicbomb",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod10-p1",
          "title": "Recognize logic bomb patterns",
          "content_blocks": [
            {
              "type": "explain",
              "text": "A logic bomb is malicious code embedded in a legitimate program that triggers when conditions are met (date, event, missing file, user change)."
            },
            {
              "type": "example",
              "text": "A payroll app deletes a database table on a specific date if a specific user account is removed."
            },
            {
              "type": "trap",
              "text": "Exam trap: logic bombs are not self-spreading malware. They are hidden inside normal apps."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "A hidden function deletes data when a date matches a condition. This is a:",
              "options": [
                "Worm",
                "Logic bomb",
                "Ransomware",
                "Botnet"
              ],
              "correct_index": 1,
              "explanation": "A condition-triggered destructive function is a logic bomb.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "cloze",
              "prompt": "Logic bombs activate when a ____ is met.",
              "answers": [
                "condition"
              ],
              "explanation": "Logic bombs trigger on a condition such as a date or event.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod11",
      "title": "Malware analysis: safe investigation workflows",
      "tag_ids": [
        "malware.analysis",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod11-p1",
          "title": "Static vs dynamic analysis",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Static analysis inspects files without executing them (hashes, strings, signatures). Dynamic analysis observes behavior in a sandbox or controlled VM."
            },
            {
              "type": "diagram",
              "text": "Safe workflow:\n1) Hash and check VirusTotal\n2) Inspect strings and metadata\n3) Detonate in a sandbox\n4) Document IoCs"
            },
            {
              "type": "trap",
              "text": "Exam trap: never detonate suspected malware on production systems."
            }
          ],
          "checks": [
            {
              "type": "matching",
              "prompt": "Match the tool to its best use.",
              "left": [
                "VirusTotal",
                "Sandbox",
                "strings"
              ],
              "right": [
                "Observe behavior safely",
                "Check multiple AV detections",
                "Extract readable artifacts"
              ],
              "correct_map": {
                "VirusTotal": "Check multiple AV detections",
                "Sandbox": "Observe behavior safely",
                "strings": "Extract readable artifacts"
              },
              "explanation": "VirusTotal aggregates AV hits, sandboxes show behavior, and strings extracts readable artifacts.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "single_choice",
              "prompt": "Which step is MOST appropriate before executing a suspicious binary?",
              "options": [
                "Run it on a domain controller",
                "Upload to a sandbox or isolated VM",
                "Disable logging",
                "Ignore it"
              ],
              "correct_index": 1,
              "explanation": "Use a sandbox or isolated VM for safe behavior analysis.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    },
    {
      "id": "ch3-mod12",
      "title": "Rootkits: stealth and trusted detection",
      "tag_ids": [
        "malware.rootkit",
        "ioc.indicators",
        "2.4"
      ],
      "pages": [
        {
          "id": "ch3-mod12-p1",
          "title": "Why rootkits are hard to remove",
          "content_blocks": [
            {
              "type": "explain",
              "text": "Rootkits aim to hide by hooking system processes or drivers. Because the OS may be compromised, on-host tools can be unreliable."
            },
            {
              "type": "example",
              "text": "If a host reports it is clean but network traffic shows active exfiltration, a rootkit is a likely cause."
            },
            {
              "type": "trap",
              "text": "Exam trap: the most reliable remediation is rebuild/restore from a known-good image."
            }
          ],
          "checks": [
            {
              "type": "single_choice",
              "prompt": "Why is rootkit detection difficult?",
              "options": [
                "Rootkits only run on air-gapped systems",
                "An infected system cannot be trusted to report its own state",
                "Rootkits never use persistence",
                "Rootkits cannot communicate over the network"
              ],
              "correct_index": 1,
              "explanation": "Rootkits hide themselves and can deceive local tools.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            },
            {
              "type": "multi_select",
              "prompt": "Which are appropriate rootkit response steps? (Select all that apply.)",
              "options": [
                "Boot from trusted media for analysis",
                "Restore/rebuild from known-good image",
                "Ignore because AV says clean",
                "Collect IoCs before reimaging"
              ],
              "correct_indices": [
                0,
                1,
                3
              ],
              "explanation": "Use trusted media, gather IoCs, and rebuild from known-good sources.",
              "objectiveIds": [
                "2.2",
                "2.3",
                "2.4",
                "3.3",
                "4.1",
                "4.4",
                "4.8"
              ]
            }
          ],
          "objectiveIds": [
            "2.2",
            "2.3",
            "2.4",
            "3.3",
            "4.1",
            "4.4",
            "4.8"
          ]
        }
      ],
      "objectiveIds": [
        "2.2",
        "2.3",
        "2.4",
        "3.3",
        "4.1",
        "4.4",
        "4.8"
      ]
    }
  ],
  "objectiveIds": [
    "2.2",
    "2.3",
    "2.4",
    "3.3",
    "4.1",
    "4.4",
    "4.8"
  ]
}
